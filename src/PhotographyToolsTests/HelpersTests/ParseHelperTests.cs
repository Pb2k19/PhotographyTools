using Photography_Tools.Helpers;

namespace PhotographyToolsTests.HelpersTests;

public class ParseHelperTests
{
    [Theory]
    [InlineData("0.0", 0)]
    [InlineData("0,0", 0)]
    [InlineData("0.01", 0.01)]
    [InlineData("0,01", 0.01)]
    [InlineData("-0.01", -0.01)]
    [InlineData("-0,01", -0.01)]
    [InlineData("0.00001", 0.00001)]
    [InlineData("45468.379684", 45468.379684)]
    [InlineData("45468,379684", 45468.379684)]
    [InlineData("-45468.379684", -45468.379684)]
    [InlineData("-45468,379684", -45468.379684)]
    [InlineData("45 468,379684", 45468.379684)]
    [InlineData("45 468.379684", 45468.379684)]
    [InlineData("45,468,379684", 45468.379684)]
    [InlineData("45,468.379684", 45468.379684)]
    [InlineData("45.468,379684", 45468.379684)]
    [InlineData("-45 468,379684", -45468.379684)]
    [InlineData("-45 468.379684", -45468.379684)]
    [InlineData("-45,468,379684", -45468.379684)]
    [InlineData("-45,468.379684", -45468.379684)]
    [InlineData("-45.468,379684", -45468.379684)]
    [InlineData("+45.468,379684", 45468.379684)]
    [InlineData("1234.56", 1234.56)]
    [InlineData("+1234.56", 1234.56)]
    [InlineData("1234,56", 1234.56)]
    [InlineData("+1234,56", 1234.56)]
    [InlineData("1.234,56", 1234.56)]
    [InlineData("1 234,56", 1234.56)]
    [InlineData("1'234.56", 1234.56)]
    [InlineData("1 234,56", 1234.56)]
    [InlineData("1,23,456.78", 123456.78)]
    [InlineData("1,234.56", 1234.56)]
    [InlineData("1234.567", 1234.567)]
    [InlineData("-12,445.68", -12445.68)]
    [InlineData("-12 445,68", -12445.68)]
    [InlineData("123,456,789.0", 123456789)]
    [InlineData("0.00000000000000000001", 0.00000000000000000001)]
    [InlineData("0,00000000000000000001", 0.00000000000000000001)]
    public void TryParseDecimalDifferentCulture_ShouldReturnTrueAndParsedValueAsDouble(string input, decimal expected)
    {
        bool tryParseActual = ParseHelper.TryParseDecimalDifferentCulture(input, out decimal actual);

        Assert.Equal(expected, actual, 20);
        Assert.True(tryParseActual);
    }

    [Theory]
    [InlineData("0.0", 0)]
    [InlineData("0,0", 0)]
    [InlineData("0.01", 0.01)]
    [InlineData("0,01", 0.01)]
    [InlineData("-0.01", -0.01)]
    [InlineData("-0,01", -0.01)]
    [InlineData("0.00001", 0.00001)]
    [InlineData("45468.379684", 45468.379684)]
    [InlineData("45468,379684", 45468.379684)]
    [InlineData("-45468.379684", -45468.379684)]
    [InlineData("-45468,379684", -45468.379684)]
    [InlineData("45 468,379684", 45468.379684)]
    [InlineData("45 468.379684", 45468.379684)]
    [InlineData("45,468,379684", 45468.379684)]
    [InlineData("45,468.379684", 45468.379684)]
    [InlineData("45.468,379684", 45468.379684)]
    [InlineData("-45 468,379684", -45468.379684)]
    [InlineData("-45 468.379684", -45468.379684)]
    [InlineData("-45,468,379684", -45468.379684)]
    [InlineData("-45,468.379684", -45468.379684)]
    [InlineData("-45.468,379684", -45468.379684)]
    [InlineData("+45.468,379684", 45468.379684)]
    [InlineData("1234.56", 1234.56)]
    [InlineData("+1234.56", 1234.56)]
    [InlineData("1234,56", 1234.56)]
    [InlineData("+1234,56", 1234.56)]
    [InlineData("1.234,56", 1234.56)]
    [InlineData("1 234,56", 1234.56)]
    [InlineData("1'234.56", 1234.56)]
    [InlineData("1 234,56", 1234.56)]
    [InlineData("1,23,456.78", 123456.78)]
    [InlineData("1,234.56", 1234.56)]
    [InlineData("1234.567", 1234.567)]
    [InlineData("-12,445.68", -12445.68)]
    [InlineData("-12 445,68", -12445.68)]
    [InlineData("123,456,789.0", 123456789)]
    [InlineData("0.00000000000000000001", 0.00000000000000000001)]
    [InlineData("0,00000000000000000001", 0.00000000000000000001)]
    public void ParseDecimalDifferentCulture_ShouldReturnParsedValueAsDouble(string input, decimal expected)
    {
        decimal actual = ParseHelper.ParseDecimalDifferentCulture(input);

        Assert.Equal(expected, actual, 20);
    }

    [Theory]
    [InlineData("0.0", 0)]
    [InlineData("0,0", 0)]
    [InlineData("0.01", 0.01)]
    [InlineData("0,01", 0.01)]
    [InlineData("-0.01", -0.01)]
    [InlineData("-0,01", -0.01)]
    [InlineData("0.00001", 0.00001)]
    [InlineData("45468.379684", 45468.379684)]
    [InlineData("45468,379684", 45468.379684)]
    [InlineData("-45468.379684", -45468.379684)]
    [InlineData("-45468,379684", -45468.379684)]
    [InlineData("45 468,379684", 45468.379684)]
    [InlineData("45 468.379684", 45468.379684)]
    [InlineData("45,468,379684", 45468.379684)]
    [InlineData("45,468.379684", 45468.379684)]
    [InlineData("45.468,379684", 45468.379684)]
    [InlineData("-45 468,379684", -45468.379684)]
    [InlineData("-45 468.379684", -45468.379684)]
    [InlineData("-45,468,379684", -45468.379684)]
    [InlineData("-45,468.379684", -45468.379684)]
    [InlineData("-45.468,379684", -45468.379684)]
    [InlineData("+45.468,379684", 45468.379684)]
    [InlineData("1234.56", 1234.56)]
    [InlineData("+1234.56", 1234.56)]
    [InlineData("1234,56", 1234.56)]
    [InlineData("+1234,56", 1234.56)]
    [InlineData("1.234,56", 1234.56)]
    [InlineData("1 234,56", 1234.56)]
    [InlineData("1'234.56", 1234.56)]
    [InlineData("1 234,56", 1234.56)]
    [InlineData("1,23,456.78", 123456.78)]
    [InlineData("1,234.56", 1234.56)]
    [InlineData("1234.567", 1234.567)]
    [InlineData("-12,445.68", -12445.68)]
    [InlineData("-12 445,68", -12445.68)]
    [InlineData("123,456,789.0", 123456789)]
    [InlineData("0.00000000000000000001", 0.00000000000000000001)]
    [InlineData("0,00000000000000000001", 0.00000000000000000001)]
    public void TryParseDoubleDifferentCulture_ShouldReturnTrueAndParsedValueAsDouble(string input, double expected)
    {
        bool tryParseActual = ParseHelper.TryParseDoubleDifferentCulture(input, out double actual);

        Assert.Equal(expected, actual, 15);
        Assert.True(tryParseActual);
    }

    [Theory]
    [InlineData("0.0", 0)]
    [InlineData("0,0", 0)]
    [InlineData("0.01", 0.01)]
    [InlineData("0,01", 0.01)]
    [InlineData("-0.01", -0.01)]
    [InlineData("-0,01", -0.01)]
    [InlineData("0.00001", 0.00001)]
    [InlineData("45468.379684", 45468.379684)]
    [InlineData("45468,379684", 45468.379684)]
    [InlineData("-45468.379684", -45468.379684)]
    [InlineData("-45468,379684", -45468.379684)]
    [InlineData("45 468,379684", 45468.379684)]
    [InlineData("45 468.379684", 45468.379684)]
    [InlineData("45,468,379684", 45468.379684)]
    [InlineData("45,468.379684", 45468.379684)]
    [InlineData("45.468,379684", 45468.379684)]
    [InlineData("-45 468,379684", -45468.379684)]
    [InlineData("-45 468.379684", -45468.379684)]
    [InlineData("-45,468,379684", -45468.379684)]
    [InlineData("-45,468.379684", -45468.379684)]
    [InlineData("-45.468,379684", -45468.379684)]
    [InlineData("+45.468,379684", 45468.379684)]
    [InlineData("1234.56", 1234.56)]
    [InlineData("+1234.56", 1234.56)]
    [InlineData("1234,56", 1234.56)]
    [InlineData("+1234,56", 1234.56)]
    [InlineData("1.234,56", 1234.56)]
    [InlineData("1 234,56", 1234.56)]
    [InlineData("1'234.56", 1234.56)]
    [InlineData("1 234,56", 1234.56)]
    [InlineData("1,23,456.78", 123456.78)]
    [InlineData("1,234.56", 1234.56)]
    [InlineData("1234.567", 1234.567)]
    [InlineData("-12,445.68", -12445.68)]
    [InlineData("-12 445,68", -12445.68)]
    [InlineData("123,456,789.0", 123456789)]
    [InlineData("0.00000000000000000001", 0.00000000000000000001)]
    [InlineData("0,00000000000000000001", 0.00000000000000000001)]
    public void ParseDoubleDifferentCulture_ShouldReturnParsedValueAsDouble(string input, double expected)
    {
        double actual = ParseHelper.ParseDoubleDifferentCulture(input);

        Assert.Equal(expected, actual, 15);
    }
}